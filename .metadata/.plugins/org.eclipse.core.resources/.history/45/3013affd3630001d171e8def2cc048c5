package com.bridgelabz.fundooadminmicroservice.service;

import java.time.LocalDateTime;

import javax.validation.Valid;

import org.springframework.beans.factory.annotation.Autowired;

import com.bridgelabz.fundooadminmicroservice.dto.FundooUserDTO;
import com.bridgelabz.fundooadminmicroservice.model.FundooUserModel;
import com.bridgelabz.fundooadminmicroservice.repository.IFundooUserRepository;
import com.bridgelabz.fundooadminmicroservice.repository.TrashRepository;
import com.bridgelabz.fundooadminmicroservice.util.ResponseClass;
import com.bridgelabz.fundooadminmicroservice.util.TokenUtill;

public class FundooUserService implements IFundooUserService {
	
	@Autowired
	IFundooUserRepository iFundooUserRepository;
	
	@Autowired
	TrashRepository trashRepository;
	
	@Autowired
	TokenUtill tokenUtill;
	
	@Autowired
	MailService mailService;

	@Override
	public ResponseClass createUser(@Valid FundooUserDTO fundooUserDTO) {
		FundooUserModel fundooUserModel = new FundooUserModel(fundooUserDTO);
		fundooUserModel.setCreatedAt(LocalDateTime.now());
		iFundooUserRepository.save(fundooUserModel);
		String body = "Admin Registration Is Successful with id :-"+fundooUserModel.getId()+"\n"+fundooUserModel;
	    String subject = "Admin Registration Success";
	    mailService.send(fundooUserModel.getEmail(), body,subject);
		return new ResponseClass(200,"success",fundooUserModel);
	}

}
